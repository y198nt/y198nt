<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Technique: Angelboy's Leak: using IO_FILE to leak libc &#183; y198</title>
<meta name=title content="Technique: Angelboy's Leak: using IO_FILE to leak libc &#183; y198"><meta name=description content="A technique for you to leak libc without output function"><meta name=keywords content="Technique,"><link rel=canonical href=https://example.org/posts/technique_angelboy_leak/><link type=text/css rel=stylesheet href=/css/main.bundle.min.0097581658ae3fa03ade917c3fd7f9cb7481cb85e5d0d460d052e00ae4281c242405c135163349d0b00a3852936d26243505c9c51f032746ec634544de345403.css integrity="sha512-AJdYFliuP6A63pF8P9f5y3SBy4Xl0NRg0FLgCuQoHCQkBcE1FjNJ0LAKOFKTbSYkNQXJxR8DJ0bsY0VE3jRUAw=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.5200170cb3ed0adabce28870bf7ff061203bbefb075c90b7b76cc561cd376288fbd116092bd2e65b027908506b03f8fd15b5613608229bdc92f93ecf6d8faa64.js integrity="sha512-UgAXDLPtCtq84ohwv3/wYSA7vvsHXJC3t2zFYc03Yoj70RYJK9LmWwJ5CFBrA/j9FbVhNggim9yS+T7PbY+qZA==" data-copy data-copied></script><script src=/js/zoom.min.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Technique: Angelboy's Leak: using IO_FILE to leak libc"><meta property="og:description" content="A technique for you to leak libc without output function"><meta property="og:type" content="article"><meta property="og:url" content="https://example.org/posts/technique_angelboy_leak/"><meta property="og:image" content="https://example.org/posts/technique_angelboy_leak/feature.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-16T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-16T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.org/posts/technique_angelboy_leak/feature.png"><meta name=twitter:title content="Technique: Angelboy's Leak: using IO_FILE to leak libc"><meta name=twitter:description content="A technique for you to leak libc without output function"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Technique: Angelboy\u0027s Leak: using IO_FILE to leak libc","headline":"Technique: Angelboy\u0027s Leak: using IO_FILE to leak libc","abstract":"A technique for you to leak libc without output function","inLanguage":"en","url":"https:\/\/example.org\/posts\/technique_angelboy_leak\/","author":{"@type":"Person","name":"y198"},"copyrightYear":"2022","dateCreated":"2022-09-16T00:00:00\u002b00:00","datePublished":"2022-09-16T00:00:00\u002b00:00","dateModified":"2022-09-16T00:00:00\u002b00:00","keywords":["Technique"],"mainEntityOfPage":"true","wordCount":"2747"}]</script><meta name=author content="y198"><link href=https://t.me/y198_b rel=me><link href=https://twitter.com/y198_nt rel=me><script src=/lib/jquery/jquery.slim.min.js integrity></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 pl-[24px] pr-[24px]" style=z-index:100><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><span class=sr-only>y198</span>
<img src=/img/blowfish_logo_transparent.png width=223 height=223 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt=y198></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">y198</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blog</p></a><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Tags</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400" style=margin-right:5px><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blog</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Tags</p></a></li></ul></div></label></div></div></div></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("menu-blur");n.style.opacity=t/300})</script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div id=hero class="h-[150px] md:h-[200px]"></div><div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom" style=background-image:url(/posts/technique_angelboy_leak/feature_hu7ba8d3f7a2ff6a928b202d7ac44eb553_3214451_1200x0_resize_box_3.png)><div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div><div class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div></div><div id=background-blur class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div><script>window.addEventListener("scroll",function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=document.getElementById("background-blur");n.style.opacity=t/300})</script><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Technique: Angelboy's Leak: using IO_FILE to leak libc</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-09-16 00:00:00 +0000 UTC">16 September 2022</time><span class="px-2 text-primary-500">&#183;</span><span>2747 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">13 mins</span></div></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=y198 src=/img/profile_hue21aa446ac9d67d6d1282066290a7a07_63579_192x192_fill_box_center_3.png><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">y198</div><div class="text-sm text-neutral-700 dark:text-neutral-400">living in fuzzing</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://t.me/y198_b target=_blank aria-label=Telegram rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/y198_nt target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open class="toc-right mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#memo-táº£n-máº¡n-má»™t-xÃ­u-vá»-technique-trÃªn>ğŸ“ Táº£n máº¡n má»™t xÃ­u vá» technique trÃªn?</a><ul><li><a href=#libc-lÃ -gÃ¬-rocket>Libc lÃ  gÃ¬ ğŸš€</a></li></ul></li><li><a href=#how-this-technique-works-face_with_monocle>How this technique works? ğŸ§</a><ul><li><a href=#Ä‘áº§u-tiÃªn-ta-pháº£i-hiá»ƒu-hÃ m-puts-hoáº¡t-Ä‘á»™ng-ra-sao-face_with_raised_eyebrow>Äáº§u tiÃªn ta pháº£i hiá»ƒu hÃ m puts hoáº¡t Ä‘á»™ng ra sao ğŸ¤¨</a></li><li><a href=#inconclusion>Inconclusion</a></li></ul></li><li><a href=#weapon>Weapon</a><ul><li><a href=#analyze>Analyze</a></li><li><a href=#hÆ°á»›ng-exploit>HÆ°á»›ng exploit</a></li></ul></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#memo-táº£n-máº¡n-má»™t-xÃ­u-vá»-technique-trÃªn>ğŸ“ Táº£n máº¡n má»™t xÃ­u vá» technique trÃªn?</a><ul><li><a href=#libc-lÃ -gÃ¬-rocket>Libc lÃ  gÃ¬ ğŸš€</a></li></ul></li><li><a href=#how-this-technique-works-face_with_monocle>How this technique works? ğŸ§</a><ul><li><a href=#Ä‘áº§u-tiÃªn-ta-pháº£i-hiá»ƒu-hÃ m-puts-hoáº¡t-Ä‘á»™ng-ra-sao-face_with_raised_eyebrow>Äáº§u tiÃªn ta pháº£i hiá»ƒu hÃ m puts hoáº¡t Ä‘á»™ng ra sao ğŸ¤¨</a></li><li><a href=#inconclusion>Inconclusion</a></li></ul></li><li><a href=#weapon>Weapon</a><ul><li><a href=#analyze>Analyze</a></li><li><a href=#hÆ°á»›ng-exploit>HÆ°á»›ng exploit</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><h2 class="relative group">ğŸ“ Táº£n máº¡n má»™t xÃ­u vá» technique trÃªn?<div id=memo-t%E1%BA%A3n-m%E1%BA%A1n-m%E1%BB%99t-x%C3%ADu-v%E1%BB%81-technique-tr%C3%AAn class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#memo-t%E1%BA%A3n-m%E1%BA%A1n-m%E1%BB%99t-x%C3%ADu-v%E1%BB%81-technique-tr%C3%AAn aria-label=Anchor>#</a></span></h2><h3 class="relative group">Libc lÃ  gÃ¬ ğŸš€<div id=libc-l%C3%A0-g%C3%AC-rocket class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#libc-l%C3%A0-g%C3%AC-rocket aria-label=Anchor>#</a></span></h3><p><em><code>(náº¿u nhÆ° cÃ¡c báº¡n Ä‘Ã£ biáº¿t libc lÃ  gÃ¬ vÃ  biáº¿t technique ret2libc thÃ¬ cÃ³ thá»ƒ bá» qua pháº§n nÃ y) </code></em><strong>Äá»‘i vá»›i má»™t sá»‘ báº¡n chÆ¡i Pwnable nÃ³i riÃªng vÃ  cÃ¡c báº¡n chÆ¡i CTF nÃ³i chung thÃ¬ Ä‘Ã£ Ã­t nhiá»u nghe Ä‘áº¿n cá»¥m tá»« &ldquo;Libc&rdquo;. Váº­y libc lÃ  gÃ¬?</strong>
<em><code>"Cá»¥m tá»« "libc" thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng nhÆ° lÃ  má»™t tá»« viáº¿t táº¯t cho "standard C library", má»™t thÆ° viá»‡n cÃ¡c hÃ m cÃ¡i mÃ  cÃ³ thá»ƒ dÃ¹ng bá»Ÿi táº¥t cáº£ C programs"</code></em></p><p>Váº­y cÃ³ nghÄ©a, Ä‘á»‹a chá»‰ gá»‘c cá»§a libc ráº¥t lÃ  quan trá»ng, khi báº¡n Ä‘Ã£ cÃ³ Ä‘á»‹a chá»‰ gá»‘c cá»§a libc báº¡n cÃ³ thá»ƒ lÃ m ráº¥t lÃ  nhiá»u thá»©, Ä‘iá»ƒn hÃ¬nh nháº¥t lÃ  báº¡n cÃ³ thá»ƒ dÃ¹ng one_gadget Ä‘á»ƒ execve(&rsquo;/bin/sh&rsquo;,0,0) hoáº·c lÃ  gá»i system(&rsquo;/bin/sh&rsquo;),&mldr;.. NÃ´m na cuá»‘i cÃ¹ng libc dÃ¹ng Ä‘á»ƒ pop a shell.
Äá»ƒ cÃ³ thá»ƒ Ä‘á»‘i phÃ³ vá»›i váº¥n Ä‘á» trÃªn, má»™t sá»‘ challenge&rsquo;s author sáº½ khÃ´ng cho báº¥t cá»© function(puts, printf,&mldr;.) Ä‘á»ƒ cÃ³ thá»ƒ leak ra Ä‘á»‹a chá»‰ cá»§a libc.<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/rGakA4H.png alt></figure></p><h2 class="relative group">How this technique works? ğŸ§<div id=how-this-technique-works-face_with_monocle class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#how-this-technique-works-face_with_monocle aria-label=Anchor>#</a></span></h2><p>MÃ¬nh khÃ´ng cháº¯c ai lÃ  ngÆ°á»i táº¡o ra technique nÃ y nhÆ°ng mÃ  láº§n Ä‘áº§u tiÃªn mÃ¬nh tháº¥y nÃ³ Ä‘Æ°á»£c Ã¡p dá»¥ng vÃ o trong ctf lÃ  vÃ o giáº£i HITCON 2018 cÃ¢u babytcache cá»§a angelboy.tw, sau Ä‘Ã³ anh áº¥y cÃ³ publish solution cho cÃ¢u nÃ y táº¡i Ä‘Ã¢y: github.com/scwuaptx/CTF/blob/master/2018-writeup/hitcon/baby_tcache.py</p><p>Váº­y nÃªn technique nÃ y yang há»“ hay gá»i lÃ : <strong>Angelboy&rsquo;s leak</strong>
Technique nÃ y sáº½ giáº£i quyáº¿t váº¥n Ä‘á» thay Ä‘á»•i cáº¥u trÃºc stdout cá»§a IO_FILE Ä‘á»ƒ cÃ³ thá»ƒ biáº¿n nÃ³ thÃ nh hÃ m puts Ä‘á»ƒ leak Ä‘á»‹a chá»‰ cá»§a libc. NÃ³ thay Ä‘á»•i cáº¥u trÃºc cá»§a stdout cá»§a IO_FILE báº±ng cÃ¡ch modify flag bit cá»§a stdout thÃ nh <code>0xfbad1800</code> vÃ  khiáº¿n cho byte cuá»‘i cá»§a <code>_IO_write_base</code> nhá» láº¡i. á» bÃªn dÆ°á»›i mÃ¬nh sáº½ nÃ³i táº¡i sao modify flag bit cá»§a stdout thÃ nh 0xfbad1800.</p><h3 class="relative group">Äáº§u tiÃªn ta pháº£i hiá»ƒu hÃ m puts hoáº¡t Ä‘á»™ng ra sao ğŸ¤¨<div id=%C4%91%E1%BA%A7u-ti%C3%AAn-ta-ph%E1%BA%A3i-hi%E1%BB%83u-h%C3%A0m-puts-ho%E1%BA%A1t-%C4%91%E1%BB%99ng-ra-sao-face_with_raised_eyebrow class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%C4%91%E1%BA%A7u-ti%C3%AAn-ta-ph%E1%BA%A3i-hi%E1%BB%83u-h%C3%A0m-puts-ho%E1%BA%A1t-%C4%91%E1%BB%99ng-ra-sao-face_with_raised_eyebrow aria-label=Anchor>#</a></span></h3><p>Má»™t cÃ¡i vÃ­ dá»¥ cÆ¡ báº£n vá» hÃ m puts gá»i trong libc, thÃ¬ mÃ¬nh sáº½ dÃ¹ng má»™t chÆ°Æ¡ng trÃ¬nh in ra &ldquo;Hello world&rdquo;, má»™t chÆ°Æ¡ng trÃ¬nh tá»« thuá»Ÿ sÆ¡ khai ai cÅ©ng pháº£i tiáº¿p xÃºc trong cÃ¡i bá»™ mÃ´n nÃ y.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>void</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;Hello World</span><span class=se>\n</span><span class=s>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>á» cÃ¡c version sau nÃ y cá»§a libc thÃ¬ khi compile á»Ÿ assembly code thÃ¬ nÃ³ sáº½ gá»i trá»±c tiáº¿p Ä‘áº¿n hÃ m printf luÃ´n nhÆ°ng mÃ  á»Ÿ cÃ¡c libc cÅ© thÃ¬ nÃ³ sáº½ gá»i Ä‘áº¿n hÃ m puts nhÆ°ng mÃ  Ä‘iá»u Ä‘Ã³ váº«n khÃ´ng quan trá»ng cho láº¯m</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-asm data-lang=asm><span class=line><span class=cl>  <span class=na>.file</span> <span class=s>&#34;hello.c&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>.section</span>  <span class=no>.rodata</span>
</span></span><span class=line><span class=cl><span class=nl>.LC0:</span>
</span></span><span class=line><span class=cl>  <span class=na>.string</span> <span class=s>&#34;Hello World!&#34;</span>
</span></span><span class=line><span class=cl>  <span class=na>.text</span>
</span></span><span class=line><span class=cl>  <span class=na>.globl</span>  <span class=no>main</span>
</span></span><span class=line><span class=cl>  <span class=na>.type</span> <span class=no>main</span><span class=p>,</span> <span class=na>@function</span>
</span></span><span class=line><span class=cl><span class=nl>main:</span>
</span></span><span class=line><span class=cl>  <span class=nf>pushq</span> <span class=nv>%rbp</span>
</span></span><span class=line><span class=cl>  <span class=nf>movq</span>  <span class=nv>%rsp</span><span class=p>,</span> <span class=nv>%rbp</span>
</span></span><span class=line><span class=cl>  <span class=nf>movl</span>  <span class=no>$.LC0</span><span class=p>,</span> <span class=nv>%edi</span>
</span></span><span class=line><span class=cl>  <span class=nf>call</span>  <span class=no>puts</span>
</span></span><span class=line><span class=cl>  <span class=nf>popq</span>  <span class=nv>%rbp</span>
</span></span><span class=line><span class=cl>  <span class=nf>ret</span>
</span></span></code></pre></div><p>Tiáº¿p theo thÃ¬ ta sáº½ xem hÃ m puts lÃ m gÃ¬ á»Ÿ libc-2.31 (phiÃªn báº£n mÃ  mÃ¬nh Ä‘ang sá»­ dá»¥ng hiá»‡n táº¡i)
Thá»±c táº¿ thÃ¬ codebase cá»§a glibc ráº¥t lÃ  rá»™ng vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³ náº±m á»Ÿ pháº¡m vá»‹ vÄ© mÃ´, vÃ¬ tháº¿ nÃªn ráº¥t khÃ³ Ä‘á»ƒ cÃ³ thá»ƒ Ä‘á»‹nh hÆ°á»›ng Ä‘Æ°á»£c má»¥c tiÃªu mÃ  mÃ¬nh cáº§n. Khi nhÃ¬n vÃ o codebase ta cÃ³ thá»ƒ tháº¥y <code>weak_alias (_IO_puts, puts)</code> á»Ÿ trong file <code>libio/ioputs.c</code>. á» trong glibc, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  báº¥t ká»³ ai khi gá»i hÃ m puts thÃ¬ thá»±c táº¿ thay vÃ o Ä‘Ã³ sáº½ gá»i IO_puts
HÃ m IO_puts nhÆ° sau</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nf>_IO_puts</span> <span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>str</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=n>EOF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>size_t</span> <span class=n>len</span> <span class=o>=</span> <span class=nf>strlen</span> <span class=p>(</span><span class=n>str</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>_IO_acquire_lock</span> <span class=p>(</span><span class=n>_IO_stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=nf>_IO_vtable_offset</span> <span class=p>(</span><span class=n>_IO_stdout</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>       <span class=o>||</span> <span class=nf>_IO_fwide</span> <span class=p>(</span><span class=n>_IO_stdout</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=nf>_IO_sputn</span> <span class=p>(</span><span class=n>_IO_stdout</span><span class=p>,</span> <span class=n>str</span><span class=p>,</span> <span class=n>len</span><span class=p>)</span> <span class=o>==</span> <span class=n>len</span>
</span></span><span class=line><span class=cl>      <span class=o>&amp;&amp;</span> <span class=nf>_IO_putc_unlocked</span> <span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>,</span> <span class=n>_IO_stdout</span><span class=p>)</span> <span class=o>!=</span> <span class=n>EOF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=nf>MIN</span> <span class=p>(</span><span class=n>INT_MAX</span><span class=p>,</span> <span class=n>len</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nf>_IO_release_lock</span> <span class=p>(</span><span class=n>_IO_stdout</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Má»› á»Ÿ trÃªn chÃºng ta khÃ´ng cáº§n pháº£i Ä‘á»ƒ Ã½ táº¥t cáº£ mÃ  chá»‰ cáº§n focus vÃ´ hÃ m IO_sputn. HÃ m IO_sputn Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a táº¡i <code>libio/libioP.h, line 374 (as a macro)</code> ÄÃ o sÃ¢u vÃ o trong ta tháº¥y nÃ³ lÃ  1 nÃ¹i cÃ¡c macro nhÃ¬n mÃ  khÃ´ng tháº¥y Ä‘Æ°á»ng ra<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/QYvhPCB.png alt></figure>Sau má»™t há»“i máº¯t mÃ¬nh Ä‘áº£o nhÆ° rang láº¡c thÃ¬ mÃ¬nh Ä‘Ã£ tÃ¬m ra Ä‘Æ°á»£c má»™t cÃ¡i function liÃªn quan Ä‘áº¿n váº¥n Ä‘á» mÃ  chÃºng ta Ä‘ang Ä‘á» cáº­p, Ä‘Ã³ chÃ­nh lÃ  <code>_IO_new_file_xsputn</code> Ä‘Æ°á»£c mÃ´ táº£ táº¡i
<code>libio/libioP.h, line 596 (as a prototype)</code> Sau má»™t thá»i gian mÃ² máº«m code cá»§a hÃ m <code>_IO_new_file_xsputn</code> thÃ¬ cuá»‘i cÃ¹ng nÃ³ cÅ©ng Ä‘Ã£ dá»«ng láº¡i táº¡i hÃ m <code>_IO_OVERFLOW</code> Ä‘Æ°á»£c defined táº¡i <code>libio/libioP.h, line 141 (as a macro)</code>
(LÃ m cÃ¡i má»› nÃ y mÃ¬nh cÅ©ng Ä‘ang khÃ´ng biáº¿t Ä‘ang lÃ m mics hay lÃ m pwn ná»¯a &mldr; ğŸ˜•)
VÃ  cuá»‘i cÃ¹ng thÃ¬ Ä‘Ã¢y chÃ­nh lÃ  cÃ¡i mÃ  chÃºng ta Ä‘ang cáº§n tÃ¬m:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span>
</span></span><span class=line><span class=cl><span class=nf>_IO_new_file_overflow</span> <span class=p>(</span><span class=n>FILE</span> <span class=o>*</span><span class=n>f</span><span class=p>,</span> <span class=kt>int</span> <span class=n>ch</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=n>_IO_NO_WRITES</span><span class=p>)</span> <span class=cm>/* SET ERROR */</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>|=</span> <span class=n>_IO_ERR_SEEN</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nf>__set_errno</span> <span class=p>(</span><span class=n>EBADF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>EOF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=cm>/* If currently reading or no buffer allocated. */</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=n>_IO_CURRENTLY_PUTTING</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>||</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=cm>/* Allocate a buffer if needed. */</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>	  <span class=nf>_IO_doallocbuf</span> <span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	  <span class=nf>_IO_setg</span> <span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_base</span><span class=p>,</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_base</span><span class=p>,</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_base</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nf>__glibc_unlikely</span> <span class=p>(</span><span class=nf>_IO_in_backup</span> <span class=p>(</span><span class=n>f</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>	  <span class=kt>size_t</span> <span class=n>nbackup</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_end</span> <span class=o>-</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	  <span class=nf>_IO_free_backup_area</span> <span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	  <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_base</span> <span class=o>-=</span> <span class=nf>MIN</span> <span class=p>(</span><span class=n>nbackup</span><span class=p>,</span>
</span></span><span class=line><span class=cl>				   <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_base</span> <span class=o>-</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_base</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	  <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_base</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span> <span class=o>==</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_end</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_base</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_end</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_end</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_base</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_ptr</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_read_end</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>|=</span> <span class=n>_IO_CURRENTLY_PUTTING</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_mode</span> <span class=o>&lt;=</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>_IO_LINE_BUF</span> <span class=o>|</span> <span class=n>_IO_UNBUFFERED</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_end</span> <span class=o>=</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>ch</span> <span class=o>==</span> <span class=n>EOF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nf>_IO_do_write</span> <span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			 <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span> <span class=o>-</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span> <span class=o>==</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_buf_end</span> <span class=p>)</span> <span class=cm>/* Buffer is really full */</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>_IO_do_flush</span> <span class=p>(</span><span class=n>f</span><span class=p>)</span> <span class=o>==</span> <span class=n>EOF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>EOF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span><span class=o>++</span> <span class=o>=</span> <span class=n>ch</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=n>_IO_UNBUFFERED</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=o>||</span> <span class=p>((</span><span class=n>f</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=n>_IO_LINE_BUF</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=n>ch</span> <span class=o>==</span> <span class=sc>&#39;\n&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>_IO_do_write</span> <span class=p>(</span><span class=n>f</span><span class=p>,</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		      <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_ptr</span> <span class=o>-</span> <span class=n>f</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span><span class=p>)</span> <span class=o>==</span> <span class=n>EOF</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>EOF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span><span class=kt>unsigned</span> <span class=kt>char</span><span class=p>)</span> <span class=n>ch</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Äá»ƒ cÃ³ thá»ƒ giáº£i thÃ­ch cÃ¡i hÃ m trÃªn thÃ¬ cháº¯c Ä‘áº¿n mÃ¹a quÃ½t mÃ¬nh má»›i giáº£i quyáº¿t Ä‘Æ°á»£c váº¥n Ä‘á» nÃ y máº¥t, chÃºng ta hÃ£y focus vÃ o hÃ m <code>_IO_do_write</code> thÃ¬ nÃ³ chÃ­nh lÃ  hÃ m cuá»‘i cÃ¹ng Ä‘Æ°á»£c gá»i vÃ  <code>_IO_write_base</code> chÃ­nh lÃ  tham sá»‘ cuá»‘i cÃ¹ng mÃ  chÃºng ta cáº§n modify. Äá»ƒ cÃ³ thá»ƒ cháº¡m Ä‘Æ°á»£c Ä‘áº¿n hÃ m if cuá»‘i cÃ¹ng thÃ¬ chÃºng ta cáº§n pháº£i bypass táº¥t cáº£ hÃ m if á»Ÿ trÃªn, chÃºng ta khÃ´ng muá»‘n pháº£i vÆ°á»›ng vÃ o má»™t trong cÃ¡c nhÃ¡nh cá»§a hÃ m if Ä‘Ã³ Ä‘Ã¢u. Quay vá» bÃªn trÃªn cÃ¹ng, chÃºng ta sáº½ bypass tá»«ng hÃ m if má»™t.</p><ul><li>á» hÃ m if Ä‘áº§u tiÃªn cÃ¡i giÃ¡ trá»‹ <code>f->flag & _IO_NO_WRITES</code> pháº£i lÃ  0, Ä‘á»ƒ khÃ´ng dÃ­nh vÃ o bÃªn trong hÃ m if.</li><li>Tiáº¿p theo chÃºng ta pháº£i set <code>f->flag & _IO_CURRENTLY_PUTTING</code> báº±ng 1 Ä‘á»ƒ khÃ´ng vÃ o bÃªn trong hÃ m if thá»© 2</li><li>ÄÃ o sÃ¢u má»™t tÃ­ vÃ o hÃ m <code>_IO_do_write</code> thÃ¬ ta sáº½ tháº¥y má»™t hÃ m ná»¯a cháº¡y cÃ¹ng vá»›i hÃ m trÃªn Ä‘Ã³ lÃ  <code>_IO_new_do_write</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>static</span> <span class=kt>size_t</span>
</span></span><span class=line><span class=cl><span class=nf>new_do_write</span> <span class=p>(</span><span class=n>FILE</span> <span class=o>*</span><span class=n>fp</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>data</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>to_do</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>size_t</span> <span class=n>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>fp</span><span class=o>-&gt;</span><span class=n>_flags</span> <span class=o>&amp;</span> <span class=n>_IO_IS_APPENDING</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fp</span><span class=o>-&gt;</span><span class=n>_offset</span> <span class=o>=</span> <span class=n>_IO_pos_BAD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>fp</span><span class=o>-&gt;</span><span class=n>_IO_read_end</span> <span class=o>!=</span> <span class=n>fp</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kt>off64_t</span> <span class=n>new_pos</span>
</span></span><span class=line><span class=cl>	<span class=o>=</span> <span class=nf>_IO_SYSSEEK</span> <span class=p>(</span><span class=n>fp</span><span class=p>,</span> <span class=n>fp</span><span class=o>-&gt;</span><span class=n>_IO_write_base</span> <span class=o>-</span> <span class=n>fp</span><span class=o>-&gt;</span><span class=n>_IO_read_end</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>new_pos</span> <span class=o>==</span> <span class=n>_IO_pos_BAD</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>fp</span><span class=o>-&gt;</span><span class=n>_offset</span> <span class=o>=</span> <span class=n>new_pos</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>count</span> <span class=o>=</span> <span class=nf>_IO_SYSWRITE</span> <span class=p>(</span><span class=n>fp</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>to_do</span><span class=p>);</span> <span class=c1>//our aim
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>count</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>VÃ  Ä‘Ã¢y chÃ­nh lÃ  má»¥c tiÃªu cuá»‘i cÃ¹ng cá»§a chÃºng ta (hoáº·c thá»© gÃ¬ Ä‘Ã³ xÃªm xÃªm) <code>_IO_SYSWRITE (fp, data, to_do)</code> Sau khi lÆ°á»£c qua cÃ¡c hÃ m if thÃ¬ Ä‘á»ƒ cÃ³ thá»ƒ bypass táº¥t cáº£ cÃ¡c hÃ m if trÃªn lÃ  báº¥t kháº£ thi(nhiá»u lÃ­ do khÃ³ cÃ³ thá»ƒ mÃ  khai thÃ¡c Ä‘Æ°á»£c, cÃ³ má»™t cÃ¡i váº¥n Ä‘á» mÃ  chÃºng ta khÃ´ng thá»ƒ control nÃ³ Ä‘Æ°á»£c Ä‘Ã³ lÃ  <code>fp->_IO_write_base - fp->_IO_read_end</code>. Náº¿u nhÆ° chÃºng ta set <code>fp->_IO_read_end</code> thÃ nh 0, dáº«n tá»›i háº­u quáº£ lÃ  tham sá»‘ thá»© 2 sáº½ quÃ¡ dÃ i, vÃ  náº¿u ta set <code>fp->_IO_write_base > fp->_IO_read_end</code> thÃ¬ chÃºng ta sáº½ dÃ­nh lá»—i á»Ÿ 1 chá»— khÃ¡c, táº¡i vÃ¬ <code>_IO_write_base</code> sáº½ trá»Ÿ nÃªn lá»›n hÆ¡n <code>_IO_write_ptr</code> mÃ  cÃ¡i ta cáº§n lÃ  <code>_IO_write_base</code> pháº£i nhá» hÆ¡n <code>_IO_write_ptr</code>), dÆ°á»ng nhÆ° chÃºng ta chá»‰ cÃ³ lá»±a chá»n skip qua hÃ m else if, Ä‘á»ƒ hiá»‡n thá»±c hÃ³a Ä‘iá»u nÃ y thÃ¬ ta cáº§n focus vÃ o<code>fp->_IO_write_base</code> vÃ  <code>fp->_IO_read_end</code>, dá»±a vÃ o source code trÃªn thÃ¬ ta cÃ³ thá»ƒ suy ra Ä‘Æ°á»£c Ä‘Ã³ lÃ  ta pháº£i set <code>fp->flags & _IO_is_appending</code></p><h3 class="relative group">Inconclusion<div id=inconclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#inconclusion aria-label=Anchor>#</a></span></h3><p><code>_IO_file</code> Ä‘Æ°á»£c bao gá»“m trong <code>_IO_FILE_plus</code> cÃ³ cáº¥u trÃºc nhÆ° bÃªn dÆ°á»›i:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>struct</span> <span class=n>_IO_FILE_plus</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>_IO_FILE</span> <span class=n>file</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=k>struct</span> <span class=n>_IO_jump_t</span> <span class=o>*</span><span class=n>vtable</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p><figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/s7xIJqW.png alt></figure><code>_IO_FILE</code> Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a dÆ°á»›i dáº¡ng linked list, Ä‘áº§u node cá»§a list trÃªn lÃ  <code>_IO_list_all</code>. TÃ³m táº¯t sÆ¡ qua thÃ¬ <code>IO_list_all</code> sáº½ trá» Ä‘áº¿n <code>stderr</code> (file descriptor lÃ  2) tiáº¿p theo sáº½ trá» Ä‘áº¿n <code>stdout</code>(file descriptor lÃ  1) vÃ  cuá»‘i cÃ¹ng trá» Ä‘áº¿n stdin(file descriptor lÃ  0).
DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng giÃ¡ trá»‹ cáº§n thiáº¿t cho viá»‡c bypass toÃ n bá»™ nhá»¯ng hÃ m if á»Ÿ bÃªn trÃªn vÃ  Ä‘áº¡t Ä‘áº¿n má»¥c tiÃªu cuá»‘i cÃ¹ng.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>_flags</span> <span class=o>=</span> <span class=mh>0xfbad0000</span> <span class=c1>//magic number
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>_flags</span> <span class=o>&amp;=</span> <span class=n>_IO_NO_WRITE</span> <span class=c1>//flag = 0xfbad0000
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>_flag</span> <span class=o>|=</span> <span class=n>_IO_CURRENTLY_PUTTING</span> <span class=c1>//flag = 0xfbad0800
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>_flag</span> <span class=o>|=</span> <span class=n>_IO_IS_APPENDING</span> <span class=c1>//flag = 0xfbad1800
</span></span></span></code></pre></div><p><em>Váº­y táº¥t cáº£ nhá»¯ng gÃ¬ chÃºng ta cáº§n lÃ m Ä‘Ã³ chÃ­nh lÃ  set <code>stdout->flags</code> thÃ nh 0xfbad1800 vÃ  Ä‘á»ƒ leak mÃ  thá»© chÃºng ta cáº§n thÃ¬ chÃºng ta pháº£i tÃ­nh toÃ¡n offset cá»¥ thá»ƒ Ä‘á»ƒ cÃ³ thá»ƒ ghi Ä‘Ã¨, cá»¥ thá»ƒ á»Ÿ Ä‘Ã¢y Ä‘Ã³ chÃ­nh lÃ  cÃ¡i chá»©c nÄƒng mÃ  ta output vÃ­ dá»¥ nhÆ° lÃ  puts cháº³ng háº¡n pháº£i dá»±a vÃ o káº¿t quáº£ cá»§a <code>IO_write_ptr - IO_write_base</code></em></p><hr><p>TrÄƒm nghe thÃ¬ khÃ´ng báº±ng má»™t tháº¥y, á»Ÿ dÆ°á»›i mÃ¬nh demo technique trÃªn báº±ng cÃ¢u weapon cá»§a giáº£i De1CTF</p><h2 class="relative group">Weapon<div id=weapon class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#weapon aria-label=Anchor>#</a></span></h2><hr><h3 class="relative group">Analyze<div id=analyze class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#analyze aria-label=Anchor>#</a></span></h3><p>NhÆ° má»™t thÃ³i quen thÃ¬ má»i challenge pwn thÃ¬ mÃ¬nh sáº½ luÃ´n check file, checksec, check cÃ¡c lá»—i cÆ¡ báº£n, v&mldr;v..<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/hZJyPLt.png alt></figure></p><p>NhÃ¬n vÃ o thÃ¬ Ä‘á» bÃ i cho má»™t file ELF 64-bit, bá»‹ stripped vÃ  full mitigation (full Ä‘á»“ full giÃ¡p &mldr;.)<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/geNstgd.png alt></figure>&ldquo;<em>LÃ  má»™t tháº±ng Ä‘Ã n Ã´ng thÃ¬ khÃ´ng chÃ¹n bÆ°á»›c trÆ°á»›c má»i thá»­ thÃ¡ch</em>&rdquo;</p><p><figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/Ky5hu8F.png alt></figure></p><p>Äá» cho ta 1 vÃ²ng láº·p, trong Ä‘Ã³ cÃ³ 3 function cÆ¡ báº£n cá»§a 1 bÃ i heap: Create, delete vÃ  khÃ´ng Ä‘Æ°á»£c cung cáº¥p hÃ m in Ä‘á»ƒ trÃ¡nh leak libc address hoáº·c nhá»¯ng address quan trá»ng, bÃ¹ láº¡i ta Ä‘Æ°á»£c hÃ m rename má»™t weapon(cháº¯c cháº¯n sáº½ cÃ³ Ã­ch trong lÆ°Æ¡ng lai)</p><ul><li>HÃ m Create: ÄÆ¡n giáº£n chá»‰ lÃ  nháº­p size cá»§a má»™t chunk, index vÃ  data cá»§a chunk Ä‘Ã³ thÃ´ng qua biáº¿n name.</li><li>HÃ m Delete: TÆ°Æ¡ng tá»± nhÆ° má»i Ä‘á» heap khÃ¡c, chá»‰ Ä‘á»‹nh free má»™t chunk Ä‘Ã£ cÃ³ sáºµn thÃ´ng qua biáº¿n index</li><li>HÃ m rename: Thay Ä‘á»•i ná»™i dung cá»§a má»™t chunk chá»‰ Ä‘á»‹nh thÃ´ng qua biáº¿n index.</li></ul><p>NhÃ¬n ká»¹ hÆ¡n báº±ng ida(mÃ¬nh Ä‘Ã£ thay Ä‘á»•i tÃªn biáº¿n vÃ  má»™t sá»‘ tÃªn hÃ m Ä‘á»ƒ nhÃ¬n hiá»ƒu rÃµ hÆ¡n)</p><ul><li><p>HÃ m main nhÆ° mÃ¬nh Ä‘Ã£ nÃ³i á»Ÿ trÃªn â¬†ï¸<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/6jjUZyg.png alt></figure></p></li><li><p>HÃ m Create:<figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/sYxmTqp.png alt></figure></p></li></ul><p>BÃ i nÃ y chá»‰ giá»›i háº¡n size cá»§a má»™t chunk trong khoáº£ng 0 Ä‘áº¿n 96, vÃ¬ libc bÃ i nÃ y cho chá»‰ lÃ  phiÃªn báº£n libc-2.23 váº­y nÃªn sáº½ khÃ´ng cÃ³ tcache mÃ  bÃ i nÃ y chá»‰ gÃ³i gá»n trong fastbin, tuy bá»‹ giá»›i háº¡n trong fastbin nhÆ°ng dÆ°á»ng nhÆ° bÃ i nÃ y khÃ´ng cÃ³ giá»›i háº¡n sá»‘ lÆ°á»£ng chunk Ä‘Æ°á»£c cho phÃ©p.</p><ul><li>HÃ m Delete:</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy src=https://i.imgur.com/7g3oZ41.png alt></figure></p><p>Bug náº±m á»Ÿ trong hÃ m delete nÃ y, báº¥t cá»© má»™t ngÆ°á»i chÆ¡i pwn nÃ o khi nhÃ¬n vÃ o hÃ m nÃ y cÅ©ng sáº½ nháº­n ra Ä‘Æ°á»£c bug :lol: Bug á»Ÿ Ä‘Ã¢y Ä‘Ã³ lÃ  hÃ m nÃ y khÃ´ng set pointer vá» null dáº«n Ä‘áº¿n lá»—i use-after-free hoáº·c lÃ  double free, cÃ³ ráº¥t lÃ  nhiá»u cÃ¡ch Ä‘á»ƒ táº­n dá»¥ng hai lá»—i nÃ y.</p><p>á» bÃ i nÃ y ta cÃ³ thá»ƒ táº­n dá»¥ng lá»—i uaf táº¡o ra chunk overlapped Ä‘á»ƒ hÃ¬nh thÃ nh unsorted bin sau Ä‘Ã³ ghi Ä‘Ã¨ fd má»™t chunk Ä‘á»ƒ leak libc, ngoÃ i ra thÃ¬ ta cÃ³ thá»ƒ táº­n dá»¥ng lá»—i uaf Ä‘á»ƒ hÆ°á»›ng Ä‘áº¿n cáº¥u trÃºc stdout, modify flags bit Ä‘á»ƒ leak libc, vÃ¬ bÃ i nÃ y khÃ´ng cÃ³ hÃ m in ra nÃªn mÃ¬nh sáº½ káº¿t há»£p cáº£ hai cÃ¡ch trÃªn Ä‘á»ƒ cÃ³ thá»ƒ leak ra Ä‘Æ°á»£c flag.</p><p>MÃ¬nh khÃ´ng biáº¿t bÃ i nÃ y rá»‘t cuá»™c bá»‹ cÃ¡i gÃ¬, nhÆ°ng mÃ  lÃ m á»Ÿ local dÃ¹ng env <code>libc-2.23.so</code> thÃ¬ bá»‹ lá»—i timeout, cÃ²n náº¿u dÃ¹ng env á»Ÿ mÃ¡y mÃ¬nh thÃ¬ khÃ´ng táº­n dá»¥ng bug á»Ÿ trÃªn Ä‘Æ°á»£c ,mÃ¬nh ngá»“i loay hoay sá»­a gáº§n cáº£ tiáº¿ng váº«n khÃ´ng fix Ä‘Æ°á»£c :sadge_pepe:. Váº­y nÃªn mÃ¬nh sáº½ nÃ³i sÆ¡ qua vá» Ã½ tÆ°á»Ÿng exploit vÃ  mÃ¬nh Ä‘á»ƒ script exploit á»Ÿ bÃªn dÆ°á»›i, cÃ²n náº¿u báº¡n muá»‘n thÃ¬ báº¡n hÃ£y debug Ä‘á»ƒ hÃ¬nh dung technique trÃªn hoáº¡t Ä‘á»™ng ra sao, I&rsquo;m so sorry :(</p><h3 class="relative group">HÆ°á»›ng exploit<div id=h%C6%B0%E1%BB%9Bng-exploit class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#h%C6%B0%E1%BB%9Bng-exploit aria-label=Anchor>#</a></span></h3><p><em>Äáº§u tiÃªn thÃ¬ fd pointer cá»§a fastbin sáº½ trá» Ä‘áº¿n libc cá»¥ thá»ƒ lÃ  <code>main_arena + 88</code>, nhÆ°ng bá»Ÿi vÃ¬ size Ä‘Æ°á»£c cho phÃ©p pháº£i nhá» hÆ¡n 0x60 nÃªn khÃ´ng thá»ƒ trá»±c tiáº¿p láº¥y Ä‘Æ°á»£c Ä‘á»‹a chá»‰ cá»§a libc thÃ´ng qua fd pointer, thay vÃ o Ä‘Ã³ ta sáº½ táº­n dá»¥ng lá»—i uaf, thÃ´ng qua bug trÃªn thÃ¬ ta cÃ³ thá»ƒ Ä‘áº©y 1 chunk vÃ o fastbin, sau Ä‘Ã³ ta cÃ³ thá»ƒ fake má»™t chunk vá»›i size tÆ°Æ¡ng thÃ­ch vá»›i size cá»§a unsorted_bin, sau Ä‘Ã³ free chunk Ä‘Ã³ má»™t láº§n ná»¯a, káº¿t quáº£ lÃ  chunk mÃ  chÃºng ta fake sáº½ náº±m trong fastbin vÃ  unsorted_bin, ngoÃ i ra fd pointer sáº½ trá» Ä‘áº¿n libc. Sau khi cÃ³ Ä‘Æ°á»£c libc thÃ¬ chá»‰ cáº§n táº­n dá»¥ng lá»—i uaf ghi Ä‘Ã¨ malloc_hook thÃ nh one_gadget Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c shell. Ã tÆ°á»Ÿng lÃ  nhÆ° váº­y.</em></p><ul><li>Äáº§u tiÃªn thÃ¬ mÃ¬nh sáº½ alloc 3 chunk vá»›i size 0x70 vÃ  sau Ä‘Ã³ free hai chunk Ä‘áº§u tiÃªn Ä‘á»ƒ táº­n dá»¥ng lá»—i uaf vá»›i má»¥c Ä‘Ã­ch chá»“ng chÃ©o cÃ¡c chunk lÃªn nhau cho bÆ°á»›c tiáº¿p theo Ä‘Ã³ lÃ  modify Ä‘á»‹a chá»‰ cáº§n muá»‘n.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x71</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>*</span><span class=mi>3</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x51</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>delete</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rename</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x10</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span> <span class=c1># bÃ¢y giá» fd cá»§a chunk 3 trá» tá»›i Ä‘á»‹a chá»‰ cá»§a chunk1+0x10</span>
</span></span></code></pre></div><ul><li>BÃ¢y giá» ta malloc chunk 4, sau Ä‘Ã³ rename chunk 4 Ä‘á»ƒ cÃ³ thá»ƒ modify size cá»§a chunk 1 bá»Ÿi vÃ¬ ta Ä‘Ã£ táº¡o 1 link giá»¯a chunk 3 vÃ  chunk 1(fd chunk 3 -> chunk1 + 0x10) cÃ³ nghÄ©a lÃ  khi ta modify chunk 3 thÃ¬ ta Ä‘ang modify chunk 1. Free chunk 1 Ä‘á»ƒ Ä‘áº©y chunk 1 vÃ o fastbin, thay Ä‘á»•i size sao cho size cá»§a chunk 1 tÆ°Æ¡ng thÃ­ch vá»›i size cá»§a unsorted_bin. Káº¿t quáº£ ta thu láº¡i Ä‘Æ°á»£c Ä‘Ã³ lÃ  chunk 1 Ä‘ang náº±m á»Ÿ fastbin vÃ  unsorted_bin</li></ul><p><em>(Minh há»a cho Ã½ tÆ°á»Ÿng trÃªn)</em></p><pre tabindex=0><code>alloc(4,0x60,p64(0)*0xb + p64(0x71))
delete(1)
rename(4,p64(0)*0xb + p64(0x91))
delete(1)
gdb.attach(r)
</code></pre><ul><li>BÃ¢y giá» thÃ¬ ta chá»‰ cáº§n modify 2 byte cuá»‘i fd pointer cá»§a chunk 1(main_arena + 88) náº±m trong unsorted_bin thÃ nh Ä‘á»‹a chá»‰ mÃ  ta muá»‘n. CÃ¡i mÃ  gáº§n nháº¥t vá»›i <code>main_arena + 88</code> chÃ­nh lÃ  <code>_IO_2_1_stdout</code>, chá»‰ cÃ³ 4 byte cuá»‘i cá»§a hai Ä‘á»‹a chá»‰ mÃ  ta nÃ³i á»Ÿ trÃªn lÃ  khÃ¡c nhau</li></ul><p>Bá»Ÿi vÃ¬ aslr trÃªn server Ä‘Æ°á»£c báº­t vÃ¬ váº­y náº¿u ta ghi Ä‘Ã¨ 0x7fxxxxx5b78 thÃ nh 0x7fxxxxx6620 thÃ¬ khÃ´ng kháº£ thi vÃ¬ 3 bits cuá»‘i 620 sáº½ giá»¯ nguyÃªn, nhÆ°ng bit thá»© 4 tá»« dÆ°á»›i lÃªn(&ldquo;6&rdquo;) sáº½ luÃ´n random</p><p>TÃ¬m kiáº¿m má»™t lÃºc thÃ¬ cÃ³ 1 Ä‘á»‹a chá»‰ phÃ¹ há»£p Ä‘Ã³ lÃ  0x7fxxxxx25dd, vÃ¬ bit 5dd(Ä‘á»‹a chá»‰ cá»§a fake chunk) giá»¯ nguyÃªn cÃ²n bit cÃ³ giÃ¡ trá»‹ &ldquo;2&rdquo; random thÃ¬ ta cÃ³ thá»ƒ brute-force Ä‘áº¿n khi nÃ o gáº·p Ä‘Æ°á»£c bit Ä‘Ã³.
Sau khi ta Ä‘Ã£ applied Ä‘á»‹a chá»‰ fd cá»§a 2 chunk(má»™t cÃ¡i náº±m á»Ÿ fastbin vÃ  cÃ¡i cÃ²n láº¡i á»Ÿ unsorted_bin) cÃ³ size 0x70 gáº§n vá»›i Ä‘á»‹a chá»‰ cá»§a <code>_IO_2_1_stdout</code> báº±ng cÃ¡ch ghi Ä‘Ã¨ Ä‘á»‹a chá»‰ cá»§a <code>main_arena+88</code> thÃ nh 0x7fxxxx25dd thÃ¬ ta sáº½ fill biáº¿n flags cá»§a <code>_IO_stdout</code> thÃ nh 0xfbad1800 vÃ  2 sá»‘ cuá»‘i cá»§a <code>_IO_write_base</code> thÃ nh \x00 sáº½ khiáº¿n cho nÃ³ nhá» hÆ¡n do Ä‘Ã³ ta sáº½ leak Ä‘Æ°á»£c nhiá»u thá»© hÆ¡n.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=n>rename</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xdd\x25</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>alloc</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span><span class=mh>0x60</span><span class=p>,</span><span class=sa>b</span><span class=s1>&#39;A&#39;</span><span class=o>*</span><span class=mh>0x33</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0xfbad1800</span><span class=p>)</span> <span class=o>+</span> <span class=n>p64</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>*</span><span class=mi>3</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Sau khi Ä‘Ã£ ghi Ä‘Ã¨ thÃ¬ struct cá»§a <code>_IO_2_1_stdout</code> sáº½ nhÆ° nÃ y</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>pwndbg</span><span class=o>&gt;</span> <span class=n>p</span> <span class=n>_IO_2_1_stdout_</span>
</span></span><span class=line><span class=cl><span class=err>$</span><span class=mi>2</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>file</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>_flags</span> <span class=o>=</span> <span class=o>-</span><span class=mi>72542208</span><span class=p>,</span>  <span class=c1>//0xfbad1800
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>_IO_read_ptr</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>_IO_read_end</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>_IO_read_base</span> <span class=o>=</span> <span class=mh>0x0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>_IO_write_base</span> <span class=o>=</span> <span class=mh>0x7ffff7dd2600</span> <span class=o>&lt;</span><span class=n>_IO_2_1_stderr_</span><span class=o>+</span><span class=mi>192</span><span class=o>&gt;</span> <span class=sc>&#39;A&#39;</span> <span class=o>&lt;</span><span class=n>repeats</span> <span class=mi>32</span> <span class=n>times</span><span class=o>&gt;</span><span class=p>,</span> <span class=c1>//ghi Ä‘Ã¨ 2 sá»‘ cuá»‘i thÃ nh \x00
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>.</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> 
</span></span><span class=line><span class=cl>  <span class=n>vtable</span> <span class=o>=</span> <span class=mh>0x7ffff7dd06e0</span> <span class=o>&lt;</span><span class=n>_IO_file_jumps</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Sau khi modified stdout thÃ¬ khi chÆ°Æ¡ng trÃ¬nh gá»i puts(á»Ÿ láº§n tiáº¿p theo) thÃ¬ chÆ°Æ¡ng trÃ¬nh sáº½ in ra Ä‘á»‹a chá»‰ cá»§a <code>_IO_2_1_stderr</code> vÃ¬ nÃ³ náº±m á»Ÿ sau <code>_IO_list_all</code>
(tá»‰ lá»‡ 1/16 khi brute-force ta sáº½ leak Ä‘Æ°á»£c Ä‘á»‹a chá»‰ cá»§a libc :lol:)<figure><img class="my-0 rounded-md" loading=lazy src=Untitled.png alt></figure></p><p>Sau khi Ä‘Ã£ cÃ³ libc base address thÃ¬ ta cÃ³ Ä‘Æ°á»£c Ä‘á»‹a chá»‰ gá»‘c cá»§a malloc_hook, sau Ä‘Ã³ dÃ¹ng theo phÆ°Æ¡ng phÃ¡p trÃªn, ta malloc má»™t chunk vá»›i size 0x60 Ä‘á»ƒ Ä‘áº©y chunk Ä‘Ã³ vÃ o fastbin, tiáº¿p theo modify fd cá»§a chunk Ä‘Ã³ vÃ o fake chunk mÃ  ta muá»‘n, á»Ÿ Ä‘Ã¢y Ä‘Ã³ lÃ  malloc_hook - 0x23. Malloc chunk Ä‘Ã³ láº¡i Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c fake chunk ta muá»‘n, sau Ä‘Ã³ malloc má»™t chunk vá»›i size 0x60, fill bá»Ÿi one_gadget. Cuá»‘i cÃ¹ng malloc má»™t chunk má»›i Ä‘á»ƒ trigger malloc_hook lÃ  cÃ³ Ä‘Æ°á»£c shell.</p></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://example.org/posts/technique_angelboy_leak/&amp;text=Technique:%20Angelboy%27s%20Leak:%20using%20IO_FILE%20to%20leak%20libc" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></a><a target=_blank class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://t.me/share/url?url=https://example.org/posts/technique_angelboy_leak/&amp;resubmit=true&amp;title=Technique:%20Angelboy%27s%20Leak:%20using%20IO_FILE%20to%20leak%20libc" title aria-label><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M248 8C111.033 8 0 119.033.0 256S111.033 504 248 504 496 392.967 496 256 384.967 8 248 8zM362.952 176.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452.0 013.53 6.716A43.765 43.765.0 01362.952 176.66z"/></svg></span></a></section></div><script>var oid="views_posts/Technique_Angelboy_leak/index.md",oid_likes="likes_posts/Technique_Angelboy_leak/index.md"</script><script type=text/javascript src=/js/page.min.5b1bad196a6075a1e11bae1dc95f24f67b610948a00525e347566c5a62338ea78f1c7224ab9a53873dcdb2a1a7d7d391b8a8ef45561297f68806c01315b0c4f6.js integrity="sha512-WxutGWpgdaHhG64dyV8k9nthCUigBSXjR1ZsWmIzjqePHHIkq5pThz3NsqGn19ORuKjvRVYSl/aIBsATFbDE9g=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span></span><span><a class="flex text-right group ml-3" href=/posts/virtualbox_e1000_0day_reproduce/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Virtualbox e1000 0day Reproduce</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2022-11-28 00:00:00 +0000 UTC">28 November 2022</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">Â©ï¸ y198 was here</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js integrity="sha512-YgYLskf03itt3kWQNmj++2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://example.org/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>